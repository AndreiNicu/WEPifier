package main;
import java.awt.Dimension;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Scanner;

import javax.swing.JDialog;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
/**
 * 
 * @author Team8
 * (Still under development)
 *	Meant to read csv files generated by the aircrack-ng and offer user
 *	select target options
 *	This class is also known as Sniffer class
 */

public class NetworkScanner extends JDialog{
	private JTextArea log;
	private JScrollPane logPane;
	private JDialog diag;
	private String ID;
	
	public NetworkScanner()
	{
		log = new JTextArea();
		logPane = new JScrollPane(log);
		
		diag = new JDialog();
		diag.setPreferredSize(new Dimension (300,400));
		diag.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
		diag.add(logPane);
		diag.setVisible(true);
		diag.pack();
		readNetworkInterfaces();
	}
	public void readNetworkInterfaces()
	{
		FilterData fd = new FilterData("dump-01.csv");
		log.setText(fd.getData());
		System.out.print("Please specify the Desired MAC for cracking: ");
		Scanner scan = new Scanner(System.in);
		int index = scan.nextInt();
		ID=fd.getAtIndex(index);
		startSniffer();
		
	}
	public void startSniffer()
	{
		 new Sniffer();
	}
	private class Sniffer
	{
		/*
		 * 1)setStopMode
		 * 2)setProcName
		 * 3)setParam
		 * 4)setRuntime
		 * 5)setPrintMode
		 */
		public Sniffer()
		{
			Thread t;
			t = new Thread(new RunApplication(false,"airodump-ng "," --bssid "+ID+" -w read mon0",-2,false));
			t.start();
			try {
				Thread.sleep(2000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			FilterData fl = new FilterData("read-01.kismet.csv");
			log.setText(fl.getData());
			Thread p = new Thread(){
				public void run()
				{
					int i=0;
					while(diag.isVisible()){
						i++;
						FilterData fl = new FilterData("read-01.kismet.csv");
						try {
							Thread.sleep(200);
						} catch (InterruptedException e) {
							// TODO Auto-generated catch block
							e.printStackTrace();
						}
						log.setText(fl.getData()+"\n "+i);
					}
				}
			};
			p.start();
		}
		
	}
}